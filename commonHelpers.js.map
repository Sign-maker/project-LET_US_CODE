{"version":3,"file":"commonHelpers.js","sources":["../src/js/cart/cartHandler.js","../src/js/cart/markup-cart-product.js","../src/js/cart/cart-products.js","../src/js/cart/cart-order.js"],"sourcesContent":["import { ShopStorage } from '../local-storage-api';\n\nconst SHOP_STORAGE = 'shop-storage';\nconst shopStorage = new ShopStorage(SHOP_STORAGE);\nconst cartContentWrapper = document.querySelector('.cart-content-container');\nconst emptyCard = document.querySelector('.empty-cart');\n\nchangeCartContentVisibillity();\n\nexport function changeCartContentVisibillity() {\n  if (shopStorage.getAllProducts().length) {\n    cartContentWrapper.classList.remove('is-hidden');\n    emptyCard.classList.add('is-hidden');\n  } else {\n    cartContentWrapper.classList.add('is-hidden');\n    emptyCard.classList.remove('is-hidden');\n  }\n}\n","const localStorageCartProduct = [\n  {\n    _id: '640c2dd963a319ea671e383b',\n    name: 'Ackee',\n    img: 'https://ftp.goit.study/img/so-yummy/ingredients/640c2dd963a319ea671e383b.png',\n    category: 'Fresh_Produce',\n    price: 8.99,\n    size: '16 oz',\n    is10PercentOff: false,\n    popularity: 8,\n  },\n  {\n    _id: '640c2dd963a319ea671e3860',\n    name: 'Allspice',\n    img: 'https://ftp.goit.study/img/so-yummy/ingredients/640c2dd963a319ea671e3860.png',\n    category: 'Pantry_Items',\n    price: 2.99,\n    size: '1.5oz',\n    is10PercentOff: false,\n    popularity: 8,\n  },\n  {\n    _id: '640c2dd963a319ea671e3660',\n    name: 'Apple Cider Vinegar',\n    img: 'https://ftp.goit.study/img/so-yummy/ingredients/640c2dd963a319ea671e3660.png',\n    price: 6.99,\n    size: '500 ml',\n    category: 'Pantry_Items',\n    is10PercentOff: false,\n    popularity: 0,\n  },\n  {\n    _id: '640c2dd963a319ea671e3861',\n    name: 'Almond Extract',\n    img: 'https://ftp.goit.study/img/so-yummy/ingredients/640c2dd963a319ea671e3861.png',\n    category: 'Pantry_Items',\n    price: 4.99,\n    size: '2oz',\n    is10PercentOff: false,\n    popularity: 0,\n  },\n];\n\nexport function markupCartProduct(arr) {\n  return arr\n    .map(({ category, img, name, price, size, _id }) => {\n      return `<li class=\"cart-item\" data-id=\"${_id}\">\n      <img class=\"cart-img-product\" src=\"${img}\" alt=\"${name}\" />\n      <div class=\"cart-product-description\">\n          <p class=\"cart-product-name\">${name}</p>\n          <p class=\"cart-product-text\">Category: <span class=\"cart-text-black gap\">${category}</span>  Size: <span class=\"cart-text-black\">${size}</span></p>\n          <p class=\"cart-product-price\">$${price}</p>\n      </div>\n      <button type=\"button\" class=\"cart-product-close-btn\">\n          <svg class=\"cart-icon-close\">\n              <use href=\"./icons.svg#icon-close\"></use>\n          </svg>\n      </button>\n  </li>`;\n    })\n    .join('');\n}\n\n// const cartList = document.querySelector('.cart-list');\n// cartList.innerHTML = markupCartProduct(localStorageCartProduct);\n\n// console.log(localStorageCartProduct.length > 3);\n// function addScrollProductInCart(localStorageCartProduct) {\n//   if (localStorageCartProduct.length > 3) {\n//     cartList.style.oveflow = 'overlay';\n//   }\n//   return;\n// }\n// addScrollProductInCart(localStorageCartProduct);\n","import { markupCartProduct } from './markup-cart-product';\nimport { ShopStorage } from '../local-storage-api';\nimport { changeCartContentVisibillity } from './cartHandler';\n\nlet arrCarts = [];\nconst navSpanForCartRef = document.querySelector('.number-of-product');\nconst headerNavSpanRef = document.querySelector('.nav-span');\nconst totalAmountRef = document.querySelector('.total-amount');\nconst cardListOrder = document.querySelector('.cart-list');\nconst shopStorage = new ShopStorage('shop-storage');\n\ncardListOrder.addEventListener('click', onRemoveOrderFromCartClick);\n\nconst deleteAllBtn = document.querySelector('.js-delete-all-btn');\ndeleteAllBtn.addEventListener('click', () => {\n  cardListOrder.innerHTML = '';\n  shopStorage.removeAllProducts();\n  changeNumberInCart(0);\n  updateTotalPrice(0);\n  changeCartContentVisibillity(); // Оновлюємо загальну вартість після видалення всіх товарів\n});\n\nfunction checkedShopStorage() {\n  const getLocalCart = shopStorage.getAllProducts() ?? [];\n  arrCarts = getLocalCart;\n  cardListOrder.innerHTML = markupCartProduct(arrCarts);\n  changeNumberInCart(arrCarts.length);\n  updateTotalPrice(arrCarts.reduce((acc, item) => acc + item.price, 0)); // Оновлюємо загальну вартість при завантаженні сторінки\n}\n\ncheckedShopStorage();\n\nexport function changeNumberInCart(number) {\n  navSpanForCartRef.textContent = number;\n  headerNavSpanRef.textContent = number;\n}\n\nexport function updateTotalPrice(total) {\n  totalAmountRef.textContent = total.toFixed(2); // Оновлюємо загальну вартість\n}\n\nfunction onRemoveOrderFromCartClick(e) {\n  if (!e.target.closest('.cart-product-close-btn')) return;\n  const objFromLi = e.target.closest('li');\n  const dataIdItem = objFromLi.dataset.id;\n  const findElementFromShopStorage = shopStorage\n    .getAllProducts()\n    .filter(item => item._id !== dataIdItem);\n  shopStorage.setAllProduct(findElementFromShopStorage);\n  checkedShopStorage();\n  updateTotalPrice(\n    findElementFromShopStorage.reduce((acc, item) => acc + item.price, 0)\n  ); // Оновлюємо загальну вартість при видаленні товарів\n  if (!shopStorage.getAllProducts.length) changeCartContentVisibillity();\n}\n","import { ShopStorage } from '../local-storage-api';\nimport { FoodBoutiqueAPI } from '../food-api';\nimport Swal from 'sweetalert2';\nimport { openSuccessModal } from '../modal-success';\nimport { updateTotalPrice } from '../cart/cart-products';\nimport { changeNumberInCart } from '../cart/cart-products';\nimport { changeCartContentVisibillity } from './cartHandler';\n\n// Функція для форматування повідомлення\nfunction formatSuccessMessage(message) {\n  const successText = 'Order Success! ';\n  const index = message.indexOf(successText);\n  if (index !== -1) {\n    return message.slice(index + successText.length);\n  }\n  return message;\n}\n\nconst shopStorage = new ShopStorage('shop-storage');\nconst foodAPI = new FoodBoutiqueAPI();\n\nconst orderForm = document.getElementById('subscription-form');\nconst cardListOrder = document.querySelector('.cart-list');\nconst emailInput = document.getElementById('email');\n\norderForm.addEventListener('submit', async (event) => {\n  event.preventDefault();\n\n  const cartItems = shopStorage.getAllProducts();\n  const email = document.getElementById('email').value;\n\n  if (cartItems && cartItems.length > 0) {\n    const orderData = {\n      email: email,\n      products: cartItems.map(item => ({ productId: item._id, amount: 1 })),\n    };\n\n    try {\n      const response = await foodAPI.placeOrder(orderData);\n\n      if (response && response.message) {\n        shopStorage.removeAllProducts();\n        openSuccessModal();\n        const modalTitle = document.querySelector('.modal-success-title');\n        const modalMessage = document.querySelector('.modal-success-message');\n\n        modalTitle.textContent = 'Order success';\n        // Використовуємо функцію для форматування повідомлення\n        modalMessage.textContent = formatSuccessMessage(response.message);\n\n        // Очистити корзину на інтерфейсі після успішного замовлення\n        cardListOrder.innerHTML = '';\n        emailInput.value = ''; // Очищення поля вводу електронної пошти\n        updateTotalPrice(0);\n        changeNumberInCart(shopStorage.getAllProducts().length);\n        changeCartContentVisibillity();\n      }\n    } catch (error) {\n      Swal.fire({\n        icon: 'error',\n        title: 'Error',\n        text: error.response.data.message,\n        showConfirmButton: true,\n        confirmButtonColor: '#6D8434',\n        showCancelButton: false,\n        customClass: {\n          popup: 'small-popup',\n          title: 'custom-title',\n          icon: 'custom-icon',\n        },\n      });\n    }\n  } else {\n    Swal.fire({\n      icon: 'error',\n      title: 'Error',\n      text: 'The cart is empty. Please add products to the cart!',\n      showConfirmButton: true,\n      confirmButtonColor: '#6D8434',\n      showCancelButton: false,\n      customClass: {\n        popup: 'small-popup',\n        title: 'custom-title',\n        icon: 'custom-icon',\n      },\n    });\n  }\n});\n"],"names":["SHOP_STORAGE","shopStorage","ShopStorage","cartContentWrapper","emptyCard","changeCartContentVisibillity","markupCartProduct","arr","category","img","name","price","size","_id","arrCarts","navSpanForCartRef","headerNavSpanRef","totalAmountRef","cardListOrder","onRemoveOrderFromCartClick","deleteAllBtn","changeNumberInCart","updateTotalPrice","checkedShopStorage","acc","item","number","total","e","dataIdItem","findElementFromShopStorage","formatSuccessMessage","message","successText","index","foodAPI","FoodBoutiqueAPI","orderForm","emailInput","event","cartItems","email","orderData","response","openSuccessModal","modalTitle","modalMessage","error","Swal"],"mappings":"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"}